{"version":3,"sources":["webpack:///C:/Users/86152/Desktop/project/health-clock-uniapp/components/oa-avatar/oa-avatar.vue?7be9","webpack:///C:/Users/86152/Desktop/project/health-clock-uniapp/components/oa-avatar/oa-avatar.vue?8ccf","webpack:///C:/Users/86152/Desktop/project/health-clock-uniapp/components/oa-avatar/oa-avatar.vue?0632","webpack:///C:/Users/86152/Desktop/project/health-clock-uniapp/components/oa-avatar/oa-avatar.vue?915e","uni-app:///components/oa-avatar/oa-avatar.vue","webpack:///C:/Users/86152/Desktop/project/health-clock-uniapp/components/oa-avatar/oa-avatar.vue?1e70","webpack:///C:/Users/86152/Desktop/project/health-clock-uniapp/components/oa-avatar/oa-avatar.vue?5f68"],"names":["name","data","cvsStyleHeight","styleDisplay","styleTop","prvTop","imgStyle","selStyle","showOper","imgSrc","btnWidth","btnDsp","watch","avatarSrc","props","avatarStyle","selWidth","selHeight","expWidth","expHeight","minScale","maxScale","canScale","canRotate","lockWidth","lockHeight","stretch","lock","noTab","inner","quality","index","created","uni","complete","methods","fWindowResize","style","v","arr","obj","parseInt","fSelect","setTimeout","count","sizeType","sourceType","success","mask","src","title","showCancel","fail","fUpload","x","y","width","height","destWidth","destHeight","canvasId","fileType","r","avatar","path","fPrvUpload","prvX","prvY","prvWidth","prvHeight","fDrawInit","allHeight","imgWidth","imgHeight","imgRadio","useWidth","useHeight","pixelRatio","left","top","canvas","canvasOper","ctxCanvas","ctxCanvasOper","fDrawImage","fHideImg","fClose","fPreview","radio","rHeight","ctxCanvasPrv","fChooseImg","fRotate","fStart","touch0","touch1","fMove","fgDistance","scaleSize","beScaleSize","rx0","ry0","l","t","b","beX","beY","fEnd","fGetImgData","resolve","reject","fColorChange","tm_now","target","i","g","max","min","d","h","s","q","p","hK","tR","tG","tB","correctRGB","createRGB","a","btop","mime","bstr","n","u8arr","type"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqI;AACrI;AAC6D;AACL;AACa;;;AAGrE;AACmK;AACnK,gBAAgB,6KAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,mGAAM;AACR,EAAE,4GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAsmB,CAAgB,mnBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACiF1nB;AACA;AAAA,eACA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAA;MACA;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACAD;IACAE;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;EACA;EACAC;IAAA;IACA;IACA;IACA;IACA;IACA;IACA,iBACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;MACA;MACA;IACA;MACA;MACA;IACA;IAEA;MACA;MACA;IACA;MACAC;QACAC;UACA;UACA;QACA;MACA;IACA;EACA;EACAC;IACAC;MACA;MACA;MACA;MACA;MAgBA;MACA;MAEA;MAEA;MACA;QACAC;QACA;QAAA,2CACAA;UAAA;QAAA;UAAA;YAAA;YACA;YACAC;YACA;cACA;cACA;gBACA;gBACA;kBACAC;gBACA;cACA;cACAD;YACA;YACAE;UACA;QAAA;UAAA;QAAA;UAAA;QAAA;QACA;MACA;MAEA,kBACA,mBACA,oCACAC,yCACAA;MACA,mBACA,oBACA,qCACAA,0CACAA;MAEA;QACA;MACA;MACA;IACA;IACAC;MAAA;MACA;MACA;MACAC;QACA;MACA;MAEAV;QACAW;QACAC;QACAC;QACAC;UACAd;YAAAe;UAAA;UACA;UACAf;YACAgB;YACAF;cACA;cACA;cACA;cACA;gBACA;gBACA;kBACA,eACA,sCACAN,6CACAA;oBACAxB,YACA,uCACAwB,8CACAA;kBACAJ;kBACAA;kBACAA,YACA;kBACAA;gBACA;kBACAJ;oBACAiB;oBACAC;kBACA;kBACA;gBACA;gBACA;cACA;cAEA;gBACA;cACA;gBACAlB;kBACAC;oBACA;kBACA;gBACA;cACA;YACA;YACAkB;cACA;YACA;YACAlB;cACAD;YACA;UACA;QACA;MACA;IACA;IACAoB;MAAA;MACA;MACA;MACAV;QACA;MACA;MAEA;QACAW;QACAC;QACAC;QACAC;QACAvC;QACAC;MASAc;QAAAe;MAAA;MACA;MACA;MACA;MACA;MACAf,yBACA;QACAqB;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACA/B;QACAiB;UACAe;UA8CA;YACAC;YACAC;YACAjC;YACA9B;UACA;QAEA;QACAmD;UACA;QACA;QACAlB;UACAD;UACA;QACA;MACA,GACA,KACA;IACA;IACAgC;MAAA;MACA;MACA;MACAtB;QACA;MACA;MAEA;QACAe;QACAC;QACAO;QACAC;QACAC;QACAC;QACAnD;QACAC;MASAc;QAAAe;MAAA;MAEA;MACA;MACA;MACA;MACAf,yBACA;QACAqB;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACA/B;QACAiB;UACAe;UA4CA;YACAC;YACAC;YACAjC;YACA9B;UACA;QAEA;QACAmD;QACAlB;UACAD;UACA;QACA;MACA,GACA,KACA;IACA;IACAqC;MAAA;MAAA;MACA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACA7D;QACAC;MAEA;MACA;MACA;MACA;MACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA,yCACA;UACA;QACA;UACA,0CACA;UACA;QACA;UACA,iDACA;UACA;QACA;UACA,kDACA;UACA;MAAA;MAEA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA,yCACA;UACA;QACA;UACA,0CACA;UACA;QACA;UACA,iDACA;UACA;QACA;UACA,kDACA;UACA;MAAA;MAEA;QACA0D;QACAC;MACA;QACAA;QACAD;MACA;QACA;UACAA;UACAC;QACA;UACAA;UACAD;QACA;MACA;QACA;UACAA;UACAC;QACA;UACAD;UACAC;QACA;MACA;MACA;QACA;QACA;QACA;UACAD;UACAC;UACA;QACA;QACA;UACAA;UACAD;UACA;QACA;MACA;MAEA;MACA;MACA;MACA;MACA;MACA;MAEA;QACAG;QACAC;QACAvB;QACAC;QACAuB;QACAC;QACAC;QACAC;MAEAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA,uBACA,GACAJ,cACA,kBACA,6CACA;MACAI,uBACAL,cACAC,KACA,iCACAtB,OACA;MACA0B;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MAEAA;QACA;UACA;UAKA;UAEAD;UACA;QACA;MACA;MAEA;IACA;IACAE;MACA;MACA;MACA;MACA;MACAF;MACAA,oBACA,mCACA,oCACA;MACAA;MACAA;MACAA,oBACA,cACA,oBACA,qBACA,eACA,eACA;MACAA;IACA;IACAG;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MACA;MACA;MACA5C;QACA;MACA;MAEA;QACAW;QACAC;QACAC;QACAC;MAOAxB;QAAAe;MAAA;MAEAf,yBACA;QACAqB;QACAC;QACAC;QACAC;QACAG;QACAC;QACA/B;QACAiB;UACA;UAEA;YACAmB;YACAC;YACAC;YACAC;YACAM;YACAC;YACAY;YACAC;UACA;YACArB;YACAC;UACA;YACAmB;YACApB;YACAC;UACA;UACAqB;UACAA;UACA;UACA;UACA;UACA;UACAA;UACAA;UASA;YACA;UACA;UACA;QAEA;QACAtC;QACAlB;UACAD;QACA;MACA,GACA,KACA;IACA;IACA0D;MAAA;MAAA;MAAA;MACA;QACA;UACA1E;UACAC;UACAC;UACAW;UACAP;UACAD;UACAF;UACAC;UACAK;UACAG;UACAF;QAEAT,aACA,mBACAA,+BACAuB,oCACAA;QACAtB,cACA,oBACAA,gCACAsB,qCACAA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;QAEA;UACAzB,WACAA,+BACAyB,oCACAA;UACAxB,YACAA,gCACAwB,qCACAA;UACA;UACA;UACA,oBACA;UACA;UACA;QACA;MACA;MACA;MACA;MACA;IACA;IACAmD;MAWA;MACA;MACA;MACA;IACA;IACAC;MACA;QACAC;QACAC;MAEA;MACA;MAEA;QACA;UACAxC;QACA;MACA;IACA;IACAyC;MACA;QACAF;QACAC;MAEA;QACA;UACAxC;UACA0C;UACAC;UACAC;QAEA;UACA;UACA;UACA;UACA;YACA;cACA1B;cACA2B;cACAC;cACAC;cACAC;cACAzC;cACA0C;cACA1B;cACAC;cACAvB;cACAC;YACA,iEACA;YACA;YACA;UACA;UAEA;QACA;QACA;QAEA;UACAH;UACAC;UACA;UACA;UACA;QACA;QAEA;MACA;QACA;UACAA;UACAkD;UACAC;QACA;UACA;YACAjC;YACA2B;YACAC;YACAC;YACAC;YACAzC;YACA0C;YACA1B;YACAC;YACAvB;YACAC;UACA;YACA;cACA;YACA;cACA;YACA;cACA;YACA;UACA;UACA;YACA;cACA;YACA;cACA;YACA;cACA;YACA;UACA;QACA;UACA;UACA;QACA;QAEA;QACA;MACA;IACA;IACAkD;MACA;QACAb;QACAC;MACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAa;MAAA;MACA;QACA;UACAzC;UACAC;UACAC;QAOApC,uBACA;UACA2B;UACAN;UACAC;UACAC;UACAC;UACAV;YACA8D;UACA;UACAzD;YACA0D;UACA;QACA,GACA,OACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBAAA,MACAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACA;gBAEA/E;kBAAAe;gBAAA;gBAAA,IAEA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAEA;cAAA;gBAGA/C,0BACAgH,wBACAC;gBAmBA;kBACAD;gBACA;kBACAC;kBACA;kBACA;kBACA;oBACApD;oBACAqD;oBACAX;oBACAY;oBACAC;oBACAC;oBACA;sBACAC;oBACA;sBACAA;oBACA;sBACAA;oBACA;sBACAA;oBACA;sBACAA;oBACA;oBACAjB;oBACA;sBACAkB;oBACA;sBACAA;oBACA;sBACAA;oBACA;oBACAvH;oBAEA;sBACAuH;oBACA;sBACAA;oBACA;oBAEA;sBACA1D;oBACA;sBACA;wBACA2D;sBACA;wBACAA;sBACA;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;wBACA;0BACA;wBACA;wBACA;0BACA;wBACA;wBACA;sBACA;sBACAC;wBACA;0BACA;wBACA;0BACA;wBACA;0BACA;wBACA;wBACA;sBACA;sBACAlE;sBACAqD;sBACAX;oBACA;oBACAyB;oBACAhB;oBACAA;oBACAA;kBACA;gBACA;gBACA/C,oBACAC,oBACAC,4BACAC;gBAEA;gBACA;gBACA;gBAQApC,uBACA;kBACA2B;kBACAN;kBACAC;kBACAC;kBACAC;kBACAxD;kBACAmD;kBACAlB;oBACAD;kBACA;gBACA,GACA,OACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACAiG;MACA;QACA;UACAC;UACAC;UACAC;UACAC;QACA;UACAA;QACA;QACA,eACA,iDACA;UAAAC;QAAA,GACA,CACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrpCA;AAAA;AAAA;AAAA;AAAy3B,CAAgB,w2BAAG,EAAC,C;;;;;;;;;;;ACA74B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/oa-avatar/oa-avatar.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./oa-avatar.vue?vue&type=template&id=ae6290a4&name=yq-avatar&\"\nvar renderjs\nimport script from \"./oa-avatar.vue?vue&type=script&lang=js&\"\nexport * from \"./oa-avatar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./oa-avatar.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/oa-avatar/oa-avatar.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./oa-avatar.vue?vue&type=template&id=ae6290a4&name=yq-avatar&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var s0 = _vm.__get_style([_vm.imgStyle])\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        s0: s0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./oa-avatar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./oa-avatar.vue?vue&type=script&lang=js&\"","<template name=\"yq-avatar\">\r\n\t<view>\r\n\t\t<image\r\n\t\t\t:src=\"imgSrc.imgSrc\"\r\n\t\t\t@tap=\"fSelect\"\r\n\t\t\t:style=\"[imgStyle]\"\r\n\t\t\tclass=\"my-avatar\"\r\n\t\t></image>\r\n\t\t<canvas\r\n\t\t\tcanvas-id=\"avatar-canvas\"\r\n\t\t\tid=\"avatar-canvas\"\r\n\t\t\tclass=\"my-canvas\"\r\n\t\t\t:style=\"{ top: styleTop, height: cvsStyleHeight }\"\r\n\t\t\tdisable-scroll=\"false\"\r\n\t\t></canvas>\r\n\t\t<canvas\r\n\t\t\tcanvas-id=\"oper-canvas\"\r\n\t\t\tid=\"oper-canvas\"\r\n\t\t\tclass=\"oper-canvas\"\r\n\t\t\t:style=\"{ top: styleTop, height: cvsStyleHeight }\"\r\n\t\t\tdisable-scroll=\"false\"\r\n\t\t\t@touchstart=\"fStart\"\r\n\t\t\t@touchmove=\"fMove\"\r\n\t\t\t@touchend=\"fEnd\"\r\n\t\t></canvas>\r\n\t\t<canvas\r\n\t\t\tcanvas-id=\"prv-canvas\"\r\n\t\t\tid=\"prv-canvas\"\r\n\t\t\tclass=\"prv-canvas\"\r\n\t\t\tdisable-scroll=\"false\"\r\n\t\t\t@touchstart=\"fHideImg\"\r\n\t\t\t:style=\"{ height: cvsStyleHeight, top: prvTop }\"\r\n\t\t></canvas>\r\n\t\t<view class=\"oper-wrapper\" :style=\"{ display: styleDisplay }\">\r\n\t\t\t<view class=\"oper\">\r\n\t\t\t\t<view class=\"btn-wrapper\" v-if=\"showOper\">\r\n\t\t\t\t\t<view @tap=\"fSelect\" hover-class=\"hover\" :style=\"{ width: btnWidth }\"\r\n\t\t\t\t\t\t><text>重选</text></view\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<view @tap=\"fClose\" hover-class=\"hover\" :style=\"{ width: btnWidth }\"\r\n\t\t\t\t\t\t><text>关闭</text></view\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<view\r\n\t\t\t\t\t\t@tap=\"fRotate\"\r\n\t\t\t\t\t\thover-class=\"hover\"\r\n\t\t\t\t\t\t:style=\"{ width: btnWidth, display: btnDsp }\"\r\n\t\t\t\t\t\t><text>旋转</text></view\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<view @tap=\"fPreview\" hover-class=\"hover\" :style=\"{ width: btnWidth }\"\r\n\t\t\t\t\t\t><text>预览</text></view\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<view @tap=\"fUpload\" hover-class=\"hover\" :style=\"{ width: btnWidth }\"\r\n\t\t\t\t\t\t><text>上传</text></view\r\n\t\t\t\t\t>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"clr-wrapper\" v-else>\r\n\t\t\t\t\t<slider\r\n\t\t\t\t\t\tclass=\"my-slider\"\r\n\t\t\t\t\t\t@change=\"fColorChange\"\r\n\t\t\t\t\t\tblock-size=\"25\"\r\n\t\t\t\t\t\tvalue=\"0\"\r\n\t\t\t\t\t\tmin=\"-100\"\r\n\t\t\t\t\t\tmax=\"100\"\r\n\t\t\t\t\t\tactiveColor=\"red\"\r\n\t\t\t\t\t\tbackgroundColor=\"green\"\r\n\t\t\t\t\t\tblock-color=\"grey\"\r\n\t\t\t\t\t\tshow-value\r\n\t\t\t\t\t></slider>\r\n\t\t\t\t\t<view\r\n\t\t\t\t\t\t@tap=\"fPrvUpload\"\r\n\t\t\t\t\t\thover-class=\"hover\"\r\n\t\t\t\t\t\t:style=\"{ width: btnWidth }\"\r\n\t\t\t\t\t\t><text>上传</text></view\r\n\t\t\t\t\t>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n/* eslint-disable */\r\nconst tabHeight = 50;\r\nexport default {\r\n\tname: 'yq-avatar',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcvsStyleHeight: '0px',\r\n\t\t\tstyleDisplay: 'none',\r\n\t\t\tstyleTop: '-10000px',\r\n\t\t\tprvTop: '-10000px',\r\n\t\t\timgStyle: {},\r\n\t\t\tselStyle: {},\r\n\t\t\tshowOper: true,\r\n\t\t\timgSrc: {\r\n\t\t\t\timgSrc: ''\r\n\t\t\t},\r\n\t\t\tbtnWidth: '19%',\r\n\t\t\tbtnDsp: 'flex'\r\n\t\t};\r\n\t},\r\n\twatch: {\r\n\t\tavatarSrc() {\r\n\t\t\tthis.imgSrc.imgSrc = this.avatarSrc;\r\n\t\t}\r\n\t},\r\n\tprops: {\r\n\t\tavatarSrc: '',\r\n\t\tavatarStyle: '',\r\n\t\tselWidth: '',\r\n\t\tselHeight: '',\r\n\t\texpWidth: '',\r\n\t\texpHeight: '',\r\n\t\tminScale: '',\r\n\t\tmaxScale: '',\r\n\t\tcanScale: '',\r\n\t\tcanRotate: '',\r\n\t\tlockWidth: '',\r\n\t\tlockHeight: '',\r\n\t\tstretch: '',\r\n\t\tlock: '',\r\n\t\tnoTab: '',\r\n\t\tinner: '',\r\n\t\tquality: '',\r\n\t\tindex: ''\r\n\t},\r\n\tcreated() {\r\n\t\tthis.ctxCanvas = uni.createCanvasContext('avatar-canvas', this);\r\n\t\tthis.ctxCanvasOper = uni.createCanvasContext('oper-canvas', this);\r\n\t\tthis.ctxCanvasPrv = uni.createCanvasContext('prv-canvas', this);\r\n\t\tthis.qlty = parseInt(this.quality) || 0.9;\r\n\t\tthis.imgSrc.imgSrc = this.avatarSrc;\r\n\t\tthis.letRotate =\r\n\t\t\tthis.canRotate === 'false' || this.inner === 'true' ? 0 : 1;\r\n\t\tthis.letScale = this.canScale === 'false' ? 0 : 1;\r\n\t\tthis.isin = this.inner === 'true' ? 1 : 0;\r\n\t\tthis.indx = this.index || undefined;\r\n\t\tthis.mnScale = this.minScale || 0.3;\r\n\t\tthis.mxScale = this.maxScale || 4;\r\n\t\tthis.noBar = this.noTab === 'true' ? 1 : 0;\r\n\t\tthis.stc = this.stretch;\r\n\t\tthis.lck = this.lock;\r\n\t\tif (this.isin) {\r\n\t\t\tthis.btnWidth = '24%';\r\n\t\t\tthis.btnDsp = 'none';\r\n\t\t} else {\r\n\t\t\tthis.btnWidth = '19%';\r\n\t\t\tthis.btnDsp = 'flex';\r\n\t\t}\r\n\r\n\t\tif (this.noBar) {\r\n\t\t\tthis.moreHeight = 0;\r\n\t\t\tthis.fWindowResize();\r\n\t\t} else {\r\n\t\t\tuni.showTabBar({\r\n\t\t\t\tcomplete: res => {\r\n\t\t\t\t\tthis.moreHeight = res.errMsg === 'showTabBar:ok' ? 50 : 0;\r\n\t\t\t\t\tthis.fWindowResize();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tfWindowResize() {\r\n\t\t\tlet sysInfo = uni.getSystemInfoSync();\r\n\t\t\tthis.platform = sysInfo.platform;\r\n\t\t\tthis.pixelRatio = sysInfo.pixelRatio;\r\n\t\t\tthis.windowWidth = sysInfo.windowWidth;\r\n\t\t\t// #ifdef H5\r\n\t\t\tthis.drawTop = sysInfo.windowTop;\r\n\t\t\tthis.windowHeight = sysInfo.windowHeight + sysInfo.windowBottom;\r\n\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight + 'px';\r\n\t\t\t// #endif\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\tif (this.platform === 'android') {\r\n\t\t\t\tthis.windowHeight = sysInfo.screenHeight + sysInfo.statusBarHeight;\r\n\t\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight + 'px';\r\n\t\t\t} else {\r\n\t\t\t\tthis.windowHeight = sysInfo.windowHeight + this.moreHeight;\r\n\t\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight + 6 + 'px';\r\n\t\t\t}\r\n\t\t\t// #endif\r\n\t\t\t// #ifdef MP\r\n\t\t\tthis.windowHeight = sysInfo.windowHeight + this.moreHeight;\r\n\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight - 2 + 'px';\r\n\t\t\t// #endif\r\n\t\t\tthis.pxRatio = this.windowWidth / 750;\r\n\r\n\t\t\tlet style = this.avatarStyle;\r\n\t\t\tif (style && style !== true && (style = style.trim())) {\r\n\t\t\t\tstyle = style.split(';');\r\n\t\t\t\tlet obj = {};\r\n\t\t\t\tfor (let v of style) {\r\n\t\t\t\t\tif (!v) continue;\r\n\t\t\t\t\tv = v.trim().split(':');\r\n\t\t\t\t\tif (v[1].indexOf('upx') >= 0) {\r\n\t\t\t\t\t\tlet arr = v[1].trim().split(' ');\r\n\t\t\t\t\t\tfor (let k in arr) {\r\n\t\t\t\t\t\t\tif (!arr[k]) continue;\r\n\t\t\t\t\t\t\tif (arr[k].indexOf('upx') >= 0) {\r\n\t\t\t\t\t\t\t\tarr[k] = parseFloat(arr[k]) * this.pxRatio + 'px';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tv[1] = arr.join(' ');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj[v[0].trim()] = v[1].trim();\r\n\t\t\t\t}\r\n\t\t\t\tthis.imgStyle = obj;\r\n\t\t\t}\r\n\r\n\t\t\tthis.expWidth &&\r\n\t\t\t\t(this.exportWidth =\r\n\t\t\t\t\tthis.expWidth.indexOf('upx') >= 0\r\n\t\t\t\t\t\t? parseInt(this.expWidth) * this.pxRatio\r\n\t\t\t\t\t\t: parseInt(this.expWidth));\r\n\t\t\tthis.expHeight &&\r\n\t\t\t\t(this.exportHeight =\r\n\t\t\t\t\tthis.expHeight.indexOf('upx') >= 0\r\n\t\t\t\t\t\t? parseInt(this.expHeight) * this.pxRatio\r\n\t\t\t\t\t\t: parseInt(this.expHeight));\r\n\r\n\t\t\tif (this.styleDisplay === 'flex') {\r\n\t\t\t\tthis.fDrawInit(true);\r\n\t\t\t}\r\n\t\t\tthis.fHideImg();\r\n\t\t},\r\n\t\tfSelect() {\r\n\t\t\tif (this.fSelecting) return;\r\n\t\t\tthis.fSelecting = true;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.fSelecting = false;\r\n\t\t\t}, 500);\r\n\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount: 1,\r\n\t\t\t\tsizeType: ['original', 'compressed'],\r\n\t\t\t\tsourceType: ['album', 'camera'],\r\n\t\t\t\tsuccess: r => {\r\n\t\t\t\t\tuni.showLoading({ mask: true });\r\n\t\t\t\t\tlet path = (this.imgPath = r.tempFilePaths[0]);\r\n\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\tsrc: path,\r\n\t\t\t\t\t\tsuccess: r => {\r\n\t\t\t\t\t\t\tthis.imgWidth = r.width;\r\n\t\t\t\t\t\t\tthis.imgHeight = r.height;\r\n\t\t\t\t\t\t\tthis.path = path;\r\n\t\t\t\t\t\t\tif (!this.hasSel) {\r\n\t\t\t\t\t\t\t\tlet style = this.selStyle || {};\r\n\t\t\t\t\t\t\t\tif (this.selWidth && this.selHeight) {\r\n\t\t\t\t\t\t\t\t\tlet selWidth =\r\n\t\t\t\t\t\t\t\t\t\t\tthis.selWidth.indexOf('upx') >= 0\r\n\t\t\t\t\t\t\t\t\t\t\t\t? parseInt(this.selWidth) * this.pxRatio\r\n\t\t\t\t\t\t\t\t\t\t\t\t: parseInt(this.selWidth),\r\n\t\t\t\t\t\t\t\t\t\tselHeight =\r\n\t\t\t\t\t\t\t\t\t\t\tthis.selHeight.indexOf('upx') >= 0\r\n\t\t\t\t\t\t\t\t\t\t\t\t? parseInt(this.selHeight) * this.pxRatio\r\n\t\t\t\t\t\t\t\t\t\t\t\t: parseInt(this.selHeight);\r\n\t\t\t\t\t\t\t\t\tstyle.width = selWidth + 'px';\r\n\t\t\t\t\t\t\t\t\tstyle.height = selHeight + 'px';\r\n\t\t\t\t\t\t\t\t\tstyle.top =\r\n\t\t\t\t\t\t\t\t\t\t(this.windowHeight - selHeight - tabHeight) / 2 + 'px';\r\n\t\t\t\t\t\t\t\t\tstyle.left = (this.windowWidth - selWidth) / 2 + 'px';\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '裁剪框的宽或高没有设置',\r\n\t\t\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.selStyle = style;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (this.noBar) {\r\n\t\t\t\t\t\t\t\tthis.fDrawInit(true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tuni.hideTabBar({\r\n\t\t\t\t\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\t\t\t\t\tthis.fDrawInit(true);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t\tthis.$mHelper.toast('error3');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tfUpload() {\r\n\t\t\tif (this.fUploading) return;\r\n\t\t\tthis.fUploading = true;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.fUploading = false;\r\n\t\t\t}, 1000);\r\n\r\n\t\t\tlet style = this.selStyle,\r\n\t\t\t\tx = parseInt(style.left),\r\n\t\t\t\ty = parseInt(style.top),\r\n\t\t\t\twidth = parseInt(style.width),\r\n\t\t\t\theight = parseInt(style.height),\r\n\t\t\t\texpWidth = this.exportWidth || width,\r\n\t\t\t\texpHeight = this.exportHeight || height;\r\n\r\n\t\t\t// #ifdef H5\r\n\t\t\tx *= this.pixelRatio;\r\n\t\t\ty *= this.pixelRatio;\r\n\t\t\texpWidth = width;\r\n\t\t\texpHeight = height;\r\n\t\t\t// #endif\r\n\r\n\t\t\tuni.showLoading({ mask: true });\r\n\t\t\tthis.styleDisplay = 'none';\r\n\t\t\tthis.styleTop = '-10000px';\r\n\t\t\tthis.hasSel = false;\r\n\t\t\tthis.fHideImg();\r\n\t\t\tuni.canvasToTempFilePath(\r\n\t\t\t\t{\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\twidth: width,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\tdestWidth: expWidth,\r\n\t\t\t\t\tdestHeight: expHeight,\r\n\t\t\t\t\tcanvasId: 'avatar-canvas',\r\n\t\t\t\t\tfileType: 'png',\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: r => {\r\n\t\t\t\t\t\tr = r.tempFilePath;\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tthis.btop(r).then(r => {\r\n\t\t\t\t\t\t\tif (this.exportWidth && this.exportHeight) {\r\n\t\t\t\t\t\t\t\tlet ctxCanvas = this.ctxCanvas;\r\n\t\t\t\t\t\t\t\t(expWidth = this.exportWidth), (expHeight = this.exportHeight);\r\n\r\n\t\t\t\t\t\t\t\tctxCanvas.drawImage(r, 0, 0, expWidth, expHeight);\r\n\t\t\t\t\t\t\t\tctxCanvas.draw(false, () => {\r\n\t\t\t\t\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\t\t\t\twidth: expWidth,\r\n\t\t\t\t\t\t\t\t\t\theight: expHeight,\r\n\t\t\t\t\t\t\t\t\t\tdestWidth: expWidth,\r\n\t\t\t\t\t\t\t\t\t\tdestHeight: expHeight,\r\n\t\t\t\t\t\t\t\t\t\tcanvasId: 'avatar-canvas',\r\n\t\t\t\t\t\t\t\t\t\tfileType: 'png',\r\n\t\t\t\t\t\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\t\t\t\t\t\tsuccess: r => {\r\n\t\t\t\t\t\t\t\t\t\t\tr = r.tempFilePath;\r\n\t\t\t\t\t\t\t\t\t\t\tthis.btop(r).then(r => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$emit('upload', {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: this.rtn\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.$mHelper.toast('error0');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.$emit('upload', {\r\n\t\t\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\t\t\tdata: this.rtn\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\t\tthis.$emit('upload', {\r\n\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\tdata: this.rtn\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: res => {\r\n\t\t\t\t\t\tthis.$mHelper.toast('error1');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.noBar || uni.showTabBar();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t},\r\n\t\tfPrvUpload() {\r\n\t\t\tif (this.fPrvUploading) return;\r\n\t\t\tthis.fPrvUploading = true;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.fPrvUploading = false;\r\n\t\t\t}, 1000);\r\n\r\n\t\t\tlet style = this.selStyle,\r\n\t\t\t\tdestWidth = parseInt(style.width),\r\n\t\t\t\tdestHeight = parseInt(style.height),\r\n\t\t\t\tprvX = this.prvX,\r\n\t\t\t\tprvY = this.prvY,\r\n\t\t\t\tprvWidth = this.prvWidth,\r\n\t\t\t\tprvHeight = this.prvHeight,\r\n\t\t\t\texpWidth = this.exportWidth || prvWidth,\r\n\t\t\t\texpHeight = this.exportHeight || prvHeight;\r\n\r\n\t\t\t// #ifdef H5\r\n\t\t\tprvX *= this.pixelRatio;\r\n\t\t\tprvY *= this.pixelRatio;\r\n\t\t\texpWidth = prvWidth;\r\n\t\t\texpHeight = prvHeight;\r\n\t\t\t// #endif\r\n\r\n\t\t\tuni.showLoading({ mask: true });\r\n\r\n\t\t\tthis.styleDisplay = 'none';\r\n\t\t\tthis.styleTop = '-10000px';\r\n\t\t\tthis.hasSel = false;\r\n\t\t\tthis.fHideImg();\r\n\t\t\tuni.canvasToTempFilePath(\r\n\t\t\t\t{\r\n\t\t\t\t\tx: prvX,\r\n\t\t\t\t\ty: prvY,\r\n\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\tdestWidth: expWidth,\r\n\t\t\t\t\tdestHeight: expHeight,\r\n\t\t\t\t\tcanvasId: 'prv-canvas',\r\n\t\t\t\t\tfileType: 'png',\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: r => {\r\n\t\t\t\t\t\tr = r.tempFilePath;\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tthis.btop(r).then(r => {\r\n\t\t\t\t\t\t\tif (this.exportWidth && this.exportHeight) {\r\n\t\t\t\t\t\t\t\tlet ctxCanvas = this.ctxCanvas;\r\n\t\t\t\t\t\t\t\t(expWidth = this.exportWidth), (expHeight = this.exportHeight);\r\n\r\n\t\t\t\t\t\t\t\tctxCanvas.drawImage(r, 0, 0, expWidth, expHeight);\r\n\t\t\t\t\t\t\t\tctxCanvas.draw(false, () => {\r\n\t\t\t\t\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\t\t\t\twidth: expWidth,\r\n\t\t\t\t\t\t\t\t\t\theight: expHeight,\r\n\t\t\t\t\t\t\t\t\t\tdestWidth: expWidth,\r\n\t\t\t\t\t\t\t\t\t\tdestHeight: expHeight,\r\n\t\t\t\t\t\t\t\t\t\tcanvasId: 'avatar-canvas',\r\n\t\t\t\t\t\t\t\t\t\tfileType: 'png',\r\n\t\t\t\t\t\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\t\t\t\t\t\tsuccess: r => {\r\n\t\t\t\t\t\t\t\t\t\t\tr = r.tempFilePath;\r\n\t\t\t\t\t\t\t\t\t\t\tthis.btop(r).then(r => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$emit('upload', {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: this.rtn\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfail: () => {}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.$emit('upload', {\r\n\t\t\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\t\t\tdata: this.rtn\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\t\tthis.$emit('upload', {\r\n\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\tdata: this.rtn\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.noBar || uni.showTabBar();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t},\r\n\t\tfDrawInit(ini = false) {\r\n\t\t\tlet allWidth = this.windowWidth,\r\n\t\t\t\tallHeight = this.windowHeight,\r\n\t\t\t\timgWidth = this.imgWidth,\r\n\t\t\t\timgHeight = this.imgHeight,\r\n\t\t\t\timgRadio = imgWidth / imgHeight,\r\n\t\t\t\tuseWidth = allWidth - 40,\r\n\t\t\t\tuseHeight = allHeight - tabHeight - 80,\r\n\t\t\t\tpixelRatio = this.pixelRatio,\r\n\t\t\t\tselWidth = parseInt(this.selStyle.width),\r\n\t\t\t\tselHeight = parseInt(this.selStyle.height);\r\n\r\n\t\t\tthis.fixWidth = 0;\r\n\t\t\tthis.fixHeight = 0;\r\n\t\t\tthis.lckWidth = 0;\r\n\t\t\tthis.lckHeight = 0;\r\n\t\t\tswitch (this.stc) {\r\n\t\t\t\tcase 'x':\r\n\t\t\t\t\tthis.fixWidth = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'y':\r\n\t\t\t\t\tthis.fixHeight = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'long':\r\n\t\t\t\t\tif (imgRadio > 1) this.fixWidth = 1;\r\n\t\t\t\t\telse this.fixHeight = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'short':\r\n\t\t\t\t\tif (imgRadio > 1) this.fixHeight = 1;\r\n\t\t\t\t\telse this.fixWidth = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'longSel':\r\n\t\t\t\t\tif (selWidth > selHeight) this.fixWidth = 1;\r\n\t\t\t\t\telse this.fixHeight = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'shortSel':\r\n\t\t\t\t\tif (selWidth > selHeight) this.fixHeight = 1;\r\n\t\t\t\t\telse this.fixWidth = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tswitch (this.lck) {\r\n\t\t\t\tcase 'x':\r\n\t\t\t\t\tthis.lckWidth = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'y':\r\n\t\t\t\t\tthis.lckHeight = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'long':\r\n\t\t\t\t\tif (imgRadio > 1) this.lckWidth = 1;\r\n\t\t\t\t\telse this.lckHeight = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'short':\r\n\t\t\t\t\tif (imgRadio > 1) this.lckHeight = 1;\r\n\t\t\t\t\telse this.lckWidth = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'longSel':\r\n\t\t\t\t\tif (selWidth > selHeight) this.lckWidth = 1;\r\n\t\t\t\t\telse this.lckHeight = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'shortSel':\r\n\t\t\t\t\tif (selWidth > selHeight) this.lckHeight = 1;\r\n\t\t\t\t\telse this.lckWidth = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (this.fixWidth) {\r\n\t\t\t\tuseWidth = selWidth;\r\n\t\t\t\tuseHeight = useWidth / imgRadio;\r\n\t\t\t} else if (this.fixHeight) {\r\n\t\t\t\tuseHeight = selHeight;\r\n\t\t\t\tuseWidth = useHeight * imgRadio;\r\n\t\t\t} else if (imgRadio < 1) {\r\n\t\t\t\tif (imgHeight < useHeight) {\r\n\t\t\t\t\tuseWidth = imgWidth;\r\n\t\t\t\t\tuseHeight = imgHeight;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuseHeight = useHeight;\r\n\t\t\t\t\tuseWidth = useHeight * imgRadio;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (imgWidth < useWidth) {\r\n\t\t\t\t\tuseWidth = imgWidth;\r\n\t\t\t\t\tuseHeight = imgHeight;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuseWidth = useWidth;\r\n\t\t\t\t\tuseHeight = useWidth / imgRadio;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.isin) {\r\n\t\t\t\tthis.scaleWidth = 0;\r\n\t\t\t\tthis.scaleHeight = 0;\r\n\t\t\t\tif (useWidth < selWidth) {\r\n\t\t\t\t\tuseWidth = selWidth;\r\n\t\t\t\t\tuseHeight = useWidth / imgRadio;\r\n\t\t\t\t\tthis.lckHeight = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (useHeight < selHeight) {\r\n\t\t\t\t\tuseHeight = selHeight;\r\n\t\t\t\t\tuseWidth = useHeight * imgRadio;\r\n\t\t\t\t\tthis.lckWidth = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.scaleSize = 1;\r\n\t\t\tthis.rotateDeg = 0;\r\n\t\t\tthis.posWidth = (allWidth - useWidth) / 2;\r\n\t\t\tthis.posHeight = (allHeight - useHeight - tabHeight) / 2;\r\n\t\t\tthis.useWidth = useWidth;\r\n\t\t\tthis.useHeight = useHeight;\r\n\r\n\t\t\tlet style = this.selStyle,\r\n\t\t\t\tleft = parseInt(style.left),\r\n\t\t\t\ttop = parseInt(style.top),\r\n\t\t\t\twidth = parseInt(style.width),\r\n\t\t\t\theight = parseInt(style.height),\r\n\t\t\t\tcanvas = this.canvas,\r\n\t\t\t\tcanvasOper = this.canvasOper,\r\n\t\t\t\tctxCanvas = this.ctxCanvas,\r\n\t\t\t\tctxCanvasOper = this.ctxCanvasOper;\r\n\r\n\t\t\tctxCanvasOper.setLineWidth(3);\r\n\t\t\tctxCanvasOper.setStrokeStyle('grey');\r\n\t\t\tctxCanvasOper.setGlobalAlpha(0.4);\r\n\t\t\tctxCanvasOper.setFillStyle('black');\r\n\t\t\tctxCanvasOper.strokeRect(left, top, width, height);\r\n\t\t\tctxCanvasOper.fillRect(0, 0, this.windowWidth, top);\r\n\t\t\tctxCanvasOper.fillRect(0, top, left, height);\r\n\t\t\tctxCanvasOper.fillRect(\r\n\t\t\t\t0,\r\n\t\t\t\ttop + height,\r\n\t\t\t\tthis.windowWidth,\r\n\t\t\t\tthis.windowHeight - height - top - tabHeight\r\n\t\t\t);\r\n\t\t\tctxCanvasOper.fillRect(\r\n\t\t\t\tleft + width,\r\n\t\t\t\ttop,\r\n\t\t\t\tthis.windowWidth - width - left,\r\n\t\t\t\theight\r\n\t\t\t);\r\n\t\t\tctxCanvasOper.setStrokeStyle('red');\r\n\t\t\tctxCanvasOper.moveTo(left + 20, top);\r\n\t\t\tctxCanvasOper.lineTo(left, top);\r\n\t\t\tctxCanvasOper.lineTo(left, top + 20);\r\n\t\t\tctxCanvasOper.moveTo(left + width - 20, top);\r\n\t\t\tctxCanvasOper.lineTo(left + width, top);\r\n\t\t\tctxCanvasOper.lineTo(left + width, top + 20);\r\n\t\t\tctxCanvasOper.moveTo(left + 20, top + height);\r\n\t\t\tctxCanvasOper.lineTo(left, top + height);\r\n\t\t\tctxCanvasOper.lineTo(left, top + height - 20);\r\n\t\t\tctxCanvasOper.moveTo(left + width - 20, top + height);\r\n\t\t\tctxCanvasOper.lineTo(left + width, top + height);\r\n\t\t\tctxCanvasOper.lineTo(left + width, top + height - 20);\r\n\t\t\tctxCanvasOper.stroke();\r\n\r\n\t\t\tctxCanvasOper.draw(false, () => {\r\n\t\t\t\tif (ini) {\r\n\t\t\t\t\tthis.styleDisplay = 'flex';\r\n\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\tthis.styleTop = this.drawTop + 'px';\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\tthis.styleTop = '0';\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\tctxCanvas.setFillStyle('black');\r\n\t\t\t\t\tthis.fDrawImage();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.$emit('avtinit');\r\n\t\t},\r\n\t\tfDrawImage() {\r\n\t\t\tlet tm_now = Date.now();\r\n\t\t\tif (tm_now - this.drawTm < 20) return;\r\n\t\t\tthis.drawTm = tm_now;\r\n\t\t\tlet ctxCanvas = this.ctxCanvas;\r\n\t\t\tctxCanvas.fillRect(0, 0, this.windowWidth, this.windowHeight - tabHeight);\r\n\t\t\tctxCanvas.translate(\r\n\t\t\t\tthis.posWidth + this.useWidth / 2,\r\n\t\t\t\tthis.posHeight + this.useHeight / 2\r\n\t\t\t);\r\n\t\t\tctxCanvas.scale(this.scaleSize, this.scaleSize);\r\n\t\t\tctxCanvas.rotate((this.rotateDeg * Math.PI) / 180);\r\n\t\t\tctxCanvas.drawImage(\r\n\t\t\t\tthis.imgPath,\r\n\t\t\t\t-this.useWidth / 2,\r\n\t\t\t\t-this.useHeight / 2,\r\n\t\t\t\tthis.useWidth,\r\n\t\t\t\tthis.useHeight\r\n\t\t\t);\r\n\t\t\tctxCanvas.draw(false);\r\n\t\t},\r\n\t\tfHideImg() {\r\n\t\t\tthis.prvImg = '';\r\n\t\t\tthis.prvTop = '-10000px';\r\n\t\t\tthis.showOper = true;\r\n\t\t\tthis.prvImgData = null;\r\n\t\t\tthis.target = null;\r\n\t\t},\r\n\t\tfClose() {\r\n\t\t\tthis.styleDisplay = 'none';\r\n\t\t\tthis.styleTop = '-10000px';\r\n\t\t\tthis.hasSel = false;\r\n\t\t\tthis.fHideImg();\r\n\t\t\tthis.noBar || uni.showTabBar();\r\n\t\t},\r\n\t\tfPreview() {\r\n\t\t\tif (this.fPreviewing) return;\r\n\t\t\tthis.fPreviewing = true;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.fPreviewing = false;\r\n\t\t\t}, 1000);\r\n\r\n\t\t\tlet style = this.selStyle,\r\n\t\t\t\tx = parseInt(style.left),\r\n\t\t\t\ty = parseInt(style.top),\r\n\t\t\t\twidth = parseInt(style.width),\r\n\t\t\t\theight = parseInt(style.height);\r\n\r\n\t\t\t// #ifdef H5\r\n\t\t\tx *= this.pixelRatio;\r\n\t\t\ty *= this.pixelRatio;\r\n\t\t\t// #endif\r\n\r\n\t\t\tuni.showLoading({ mask: true });\r\n\r\n\t\t\tuni.canvasToTempFilePath(\r\n\t\t\t\t{\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\twidth: width,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\tcanvasId: 'avatar-canvas',\r\n\t\t\t\t\tfileType: 'png',\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: r => {\r\n\t\t\t\t\t\tthis.prvImgTmp = r = r.tempFilePath;\r\n\r\n\t\t\t\t\t\tlet ctxCanvasPrv = this.ctxCanvasPrv,\r\n\t\t\t\t\t\t\tprvX = this.windowWidth,\r\n\t\t\t\t\t\t\tprvY = parseInt(this.cvsStyleHeight),\r\n\t\t\t\t\t\t\tprvWidth = parseInt(this.selStyle.width),\r\n\t\t\t\t\t\t\tprvHeight = parseInt(this.selStyle.height),\r\n\t\t\t\t\t\t\tuseWidth = prvX - 40,\r\n\t\t\t\t\t\t\tuseHeight = prvY - 80,\r\n\t\t\t\t\t\t\tradio = useWidth / prvWidth,\r\n\t\t\t\t\t\t\trHeight = prvHeight * radio;\r\n\t\t\t\t\t\tif (rHeight < useHeight) {\r\n\t\t\t\t\t\t\tprvWidth = useWidth;\r\n\t\t\t\t\t\t\tprvHeight = rHeight;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tradio = useHeight / prvHeight;\r\n\t\t\t\t\t\t\tprvWidth *= radio;\r\n\t\t\t\t\t\t\tprvHeight = useHeight;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tctxCanvasPrv.setFillStyle('black');\r\n\t\t\t\t\t\tctxCanvasPrv.fillRect(0, 0, prvX, prvY);\r\n\t\t\t\t\t\tthis.prvX = prvX = (prvX - prvWidth) / 2;\r\n\t\t\t\t\t\tthis.prvY = prvY = (prvY - prvHeight) / 2;\r\n\t\t\t\t\t\tthis.prvWidth = prvWidth;\r\n\t\t\t\t\t\tthis.prvHeight = prvHeight;\r\n\t\t\t\t\t\tctxCanvasPrv.drawImage(r, prvX, prvY, prvWidth, prvHeight);\r\n\t\t\t\t\t\tctxCanvasPrv.draw(false);\r\n\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tthis.btop(r).then(r => {\r\n\t\t\t\t\t\t\tthis.showOper = false;\r\n\t\t\t\t\t\t\tthis.prvTop = this.drawTop + 'px';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\t\tif (this.platform != 'android') {\r\n\t\t\t\t\t\t\tthis.showOper = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.prvTop = '0';\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t},\r\n\t\tfChooseImg(index = undefined, params = undefined, data = undefined) {\r\n\t\t\tif (params) {\r\n\t\t\t\tlet selWidth = params.selWidth,\r\n\t\t\t\t\tselHeight = params.selHeight,\r\n\t\t\t\t\texpWidth = params.expWidth,\r\n\t\t\t\t\texpHeight = params.expHeight,\r\n\t\t\t\t\tquality = params.quality,\r\n\t\t\t\t\tcanRotate = params.canRotate,\r\n\t\t\t\t\tcanScale = params.canScale,\r\n\t\t\t\t\tminScale = params.minScale,\r\n\t\t\t\t\tmaxScale = params.maxScale,\r\n\t\t\t\t\tstretch = params.stretch,\r\n\t\t\t\t\tinner = params.inner,\r\n\t\t\t\t\tlock = params.lock;\r\n\r\n\t\t\t\texpWidth &&\r\n\t\t\t\t\t(this.exportWidth =\r\n\t\t\t\t\t\texpWidth.indexOf('upx') >= 0\r\n\t\t\t\t\t\t\t? parseInt(expWidth) * this.pxRatio\r\n\t\t\t\t\t\t\t: parseInt(expWidth));\r\n\t\t\t\texpHeight &&\r\n\t\t\t\t\t(this.exportHeight =\r\n\t\t\t\t\t\texpHeight.indexOf('upx') >= 0\r\n\t\t\t\t\t\t\t? parseInt(expHeight) * this.pxRatio\r\n\t\t\t\t\t\t\t: parseInt(expHeight));\r\n\t\t\t\tthis.letRotate = canRotate === 'false' ? 0 : 1;\r\n\t\t\t\tthis.letScale = canScale === 'false' ? 0 : 1;\r\n\t\t\t\tthis.qlty = parseInt(quality) || 0.9;\r\n\t\t\t\tthis.mnScale = minScale || 0.3;\r\n\t\t\t\tthis.mxScale = maxScale || 4;\r\n\t\t\t\tthis.stc = stretch;\r\n\t\t\t\tthis.isin = inner === 'true' ? 1 : 0;\r\n\t\t\t\tthis.lck = lock;\r\n\t\t\t\tif (this.isin) {\r\n\t\t\t\t\tthis.btnWidth = '24%';\r\n\t\t\t\t\tthis.btnDsp = 'none';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.btnWidth = '19%';\r\n\t\t\t\t\tthis.btnDsp = 'flex';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (selWidth && selHeight) {\r\n\t\t\t\t\tselWidth =\r\n\t\t\t\t\t\tselWidth.indexOf('upx') >= 0\r\n\t\t\t\t\t\t\t? parseInt(selWidth) * this.pxRatio\r\n\t\t\t\t\t\t\t: parseInt(selWidth);\r\n\t\t\t\t\tselHeight =\r\n\t\t\t\t\t\tselHeight.indexOf('upx') >= 0\r\n\t\t\t\t\t\t\t? parseInt(selHeight) * this.pxRatio\r\n\t\t\t\t\t\t\t: parseInt(selHeight);\r\n\t\t\t\t\tthis.selStyle.width = selWidth + 'px';\r\n\t\t\t\t\tthis.selStyle.height = selHeight + 'px';\r\n\t\t\t\t\tthis.selStyle.top =\r\n\t\t\t\t\t\t(this.windowHeight - selHeight - tabHeight) / 2 + 'px';\r\n\t\t\t\t\tthis.selStyle.left = (this.windowWidth - selWidth) / 2 + 'px';\r\n\t\t\t\t\tthis.hasSel = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.rtn = data;\r\n\t\t\tthis.indx = index;\r\n\t\t\tthis.fSelect();\r\n\t\t},\r\n\t\tfRotate() {\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\tif (this.platform === 'android') {\r\n\t\t\t\tif (this.fRotateing) return;\r\n\t\t\t\tthis.fRotateing = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.fRotateing = false;\r\n\t\t\t\t}, 500);\r\n\t\t\t}\r\n\t\t\t// #endif\r\n\r\n\t\t\t// if(this.letRotate) {\r\n\t\t\tthis.rotateDeg += 90 - (this.rotateDeg % 90);\r\n\t\t\tthis.fDrawImage();\r\n\t\t\t// }\r\n\t\t},\r\n\t\tfStart(e) {\r\n\t\t\tlet touches = e.touches,\r\n\t\t\t\ttouch0 = touches[0],\r\n\t\t\t\ttouch1 = touches[1];\r\n\r\n\t\t\tthis.touch0 = touch0;\r\n\t\t\tthis.touch1 = touch1;\r\n\r\n\t\t\tif (touch1) {\r\n\t\t\t\tlet x = touch1.x - touch0.x,\r\n\t\t\t\t\ty = touch1.y - touch0.y;\r\n\t\t\t\tthis.fgDistance = Math.sqrt(x * x + y * y);\r\n\t\t\t}\r\n\t\t},\r\n\t\tfMove(e) {\r\n\t\t\tlet touches = e.touches,\r\n\t\t\t\ttouch0 = touches[0],\r\n\t\t\t\ttouch1 = touches[1];\r\n\r\n\t\t\tif (touch1) {\r\n\t\t\t\tlet x = touch1.x - touch0.x,\r\n\t\t\t\t\ty = touch1.y - touch0.y,\r\n\t\t\t\t\tfgDistance = Math.sqrt(x * x + y * y),\r\n\t\t\t\t\tscaleSize = 0.005 * (fgDistance - this.fgDistance),\r\n\t\t\t\t\tbeScaleSize = this.scaleSize + scaleSize;\r\n\r\n\t\t\t\tdo {\r\n\t\t\t\t\tif (!this.letScale) break;\r\n\t\t\t\t\tif (beScaleSize < this.mnScale) break;\r\n\t\t\t\t\tif (beScaleSize > this.mxScale) break;\r\n\t\t\t\t\tif (this.isin) {\r\n\t\t\t\t\t\tlet imgWidth = this.useWidth * beScaleSize,\r\n\t\t\t\t\t\t\timgHeight = this.useHeight * beScaleSize,\r\n\t\t\t\t\t\t\trx0 = this.posWidth + this.useWidth / 2,\r\n\t\t\t\t\t\t\try0 = this.posHeight + this.useHeight / 2,\r\n\t\t\t\t\t\t\tl = rx0 - imgWidth / 2,\r\n\t\t\t\t\t\t\tt = ry0 - imgHeight / 2,\r\n\t\t\t\t\t\t\tr = l + imgWidth,\r\n\t\t\t\t\t\t\tb = t + imgHeight,\r\n\t\t\t\t\t\t\tleft = parseInt(this.selStyle.left),\r\n\t\t\t\t\t\t\ttop = parseInt(this.selStyle.top),\r\n\t\t\t\t\t\t\twidth = parseInt(this.selStyle.width),\r\n\t\t\t\t\t\t\theight = parseInt(this.selStyle.height);\r\n\t\t\t\t\t\tif (left < l || left + width > r || top < t || top + height > b)\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tthis.scaleWidth = (this.useWidth - imgWidth) / 2;\r\n\t\t\t\t\t\tthis.scaleHeight = (this.useHeight - imgHeight) / 2;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.scaleSize = beScaleSize;\r\n\t\t\t\t} while (0);\r\n\t\t\t\tthis.fgDistance = fgDistance;\r\n\r\n\t\t\t\tif (touch1.x !== touch0.x && this.letRotate) {\r\n\t\t\t\t\tx = (this.touch1.y - this.touch0.y) / (this.touch1.x - this.touch0.x);\r\n\t\t\t\t\ty = (touch1.y - touch0.y) / (touch1.x - touch0.x);\r\n\t\t\t\t\tthis.rotateDeg += (Math.atan((y - x) / (1 + x * y)) * 180) / Math.PI;\r\n\t\t\t\t\tthis.touch0 = touch0;\r\n\t\t\t\t\tthis.touch1 = touch1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.fDrawImage();\r\n\t\t\t} else if (this.touch0) {\r\n\t\t\t\tlet x = touch0.x - this.touch0.x,\r\n\t\t\t\t\ty = touch0.y - this.touch0.y,\r\n\t\t\t\t\tbeX = this.posWidth + x,\r\n\t\t\t\t\tbeY = this.posHeight + y;\r\n\t\t\t\tif (this.isin) {\r\n\t\t\t\t\tlet imgWidth = this.useWidth * this.scaleSize,\r\n\t\t\t\t\t\timgHeight = this.useHeight * this.scaleSize,\r\n\t\t\t\t\t\trx0 = beX + this.useWidth / 2,\r\n\t\t\t\t\t\try0 = beY + this.useHeight / 2,\r\n\t\t\t\t\t\tl = rx0 - imgWidth / 2,\r\n\t\t\t\t\t\tt = ry0 - imgHeight / 2,\r\n\t\t\t\t\t\tr = l + imgWidth,\r\n\t\t\t\t\t\tb = t + imgHeight,\r\n\t\t\t\t\t\tleft = parseInt(this.selStyle.left),\r\n\t\t\t\t\t\ttop = parseInt(this.selStyle.top),\r\n\t\t\t\t\t\twidth = parseInt(this.selStyle.width),\r\n\t\t\t\t\t\theight = parseInt(this.selStyle.height);\r\n\t\t\t\t\tif (!this.lckWidth && Math.abs(x) < 100) {\r\n\t\t\t\t\t\tif (left >= l && left + width <= r) {\r\n\t\t\t\t\t\t\tthis.posWidth = beX;\r\n\t\t\t\t\t\t} else if (left < l) {\r\n\t\t\t\t\t\t\tthis.posWidth = left - this.scaleWidth;\r\n\t\t\t\t\t\t} else if (left + width > r) {\r\n\t\t\t\t\t\t\tthis.posWidth = left - (imgWidth - width) - this.scaleWidth;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.lckHeight && Math.abs(y) < 100) {\r\n\t\t\t\t\t\tif (top >= t && top + height <= b) {\r\n\t\t\t\t\t\t\tthis.posHeight = beY;\r\n\t\t\t\t\t\t} else if (top < t) {\r\n\t\t\t\t\t\t\tthis.posHeight = top - this.scaleHeight;\r\n\t\t\t\t\t\t} else if (top + height > b) {\r\n\t\t\t\t\t\t\tthis.posHeight = top - (imgHeight - height) - this.scaleHeight;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (Math.abs(x) < 100 && !this.lckWidth) this.posWidth = beX;\r\n\t\t\t\t\tif (Math.abs(y) < 100 && !this.lckHeight) this.posHeight = beY;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.touch0 = touch0;\r\n\t\t\t\tthis.fDrawImage();\r\n\t\t\t}\r\n\t\t},\r\n\t\tfEnd(e) {\r\n\t\t\tlet touches = e.touches,\r\n\t\t\t\ttouch0 = touches && touches[0],\r\n\t\t\t\ttouch1 = touches && touches[1];\r\n\t\t\tif (touch0) {\r\n\t\t\t\tthis.touch0 = touch0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.touch0 = null;\r\n\t\t\t\tthis.touch1 = null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tfGetImgData() {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tlet prvX = this.prvX,\r\n\t\t\t\t\tprvY = this.prvY,\r\n\t\t\t\t\tprvWidth = this.prvWidth,\r\n\t\t\t\t\tprvHeight = this.prvHeight;\r\n\t\t\t\t// #ifdef APP-PLUS||H5\r\n\t\t\t\tprvX *= this.pixelRatio;\r\n\t\t\t\tprvY *= this.pixelRatio;\r\n\t\t\t\tprvWidth *= this.pixelRatio;\r\n\t\t\t\tprvHeight *= this.pixelRatio;\r\n\t\t\t\t// #endif\r\n\t\t\t\tuni.canvasGetImageData(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcanvasId: 'prv-canvas',\r\n\t\t\t\t\t\tx: prvX,\r\n\t\t\t\t\t\ty: prvY,\r\n\t\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tresolve(res.data);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t},\r\n\t\tasync fColorChange(e) {\r\n\t\t\tlet tm_now = Date.now();\r\n\t\t\tif (tm_now - this.prvTm < 100) return;\r\n\t\t\tthis.prvTm = tm_now;\r\n\r\n\t\t\tuni.showLoading({ mask: true });\r\n\r\n\t\t\tif (!this.prvImgData) {\r\n\t\t\t\tif (!(this.prvImgData = await this.fGetImgData().catch(res => {})))\r\n\t\t\t\t\treturn;\r\n\t\t\t\tthis.target = new Uint8ClampedArray(this.prvImgData.length);\r\n\t\t\t}\r\n\r\n\t\t\tlet data = this.prvImgData,\r\n\t\t\t\ttarget = this.target,\r\n\t\t\t\ti = e.detail.value,\r\n\t\t\t\tr,\r\n\t\t\t\tg,\r\n\t\t\t\tb,\r\n\t\t\t\ta,\r\n\t\t\t\th,\r\n\t\t\t\ts,\r\n\t\t\t\tl,\r\n\t\t\t\td,\r\n\t\t\t\tp,\r\n\t\t\t\tq,\r\n\t\t\t\tt,\r\n\t\t\t\tmin,\r\n\t\t\t\tmax,\r\n\t\t\t\thK,\r\n\t\t\t\ttR,\r\n\t\t\t\ttG,\r\n\t\t\t\ttB;\r\n\r\n\t\t\tif (i === 0) {\r\n\t\t\t\ttarget = data;\r\n\t\t\t} else {\r\n\t\t\t\ti = (i + 100) / 200;\r\n\t\t\t\tif (i < 0.005) i = 0;\r\n\t\t\t\tif (i > 0.995) i = 1;\r\n\t\t\t\tfor (let n = data.length - 1; n >= 0; n -= 4) {\r\n\t\t\t\t\tr = data[n - 3] / 255;\r\n\t\t\t\t\tg = data[n - 2] / 255;\r\n\t\t\t\t\tb = data[n - 1] / 255;\r\n\t\t\t\t\tmax = Math.max(r, g, b);\r\n\t\t\t\t\tmin = Math.min(r, g, b);\r\n\t\t\t\t\td = max - min;\r\n\t\t\t\t\tif (max === min) {\r\n\t\t\t\t\t\th = 0;\r\n\t\t\t\t\t} else if (max === r && g >= b) {\r\n\t\t\t\t\t\th = 60 * ((g - b) / d);\r\n\t\t\t\t\t} else if (max === r && g < b) {\r\n\t\t\t\t\t\th = 60 * ((g - b) / d) + 360;\r\n\t\t\t\t\t} else if (max === g) {\r\n\t\t\t\t\t\th = 60 * ((b - r) / d) + 120;\r\n\t\t\t\t\t} else if (max === b) {\r\n\t\t\t\t\t\th = 60 * ((r - g) / d) + 240;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tl = (max + min) / 2;\r\n\t\t\t\t\tif (l === 0 || max === min) {\r\n\t\t\t\t\t\ts = 0;\r\n\t\t\t\t\t} else if (0 < l && l <= 0.5) {\r\n\t\t\t\t\t\ts = d / (2 * l);\r\n\t\t\t\t\t} else if (l > 0.5) {\r\n\t\t\t\t\t\ts = d / (2 - 2 * l);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdata[n] && (a = data[n]);\r\n\r\n\t\t\t\t\tif (i < 0.5) {\r\n\t\t\t\t\t\ts = (s * i) / 0.5;\r\n\t\t\t\t\t} else if (i > 0.5) {\r\n\t\t\t\t\t\ts = 2 * s + 2 * i - (s * i) / 0.5 - 1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (s === 0) {\r\n\t\t\t\t\t\tr = g = b = Math.round(l * 255);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (l < 0.5) {\r\n\t\t\t\t\t\t\tq = l * (1 + s);\r\n\t\t\t\t\t\t} else if (l >= 0.5) {\r\n\t\t\t\t\t\t\tq = l + s - l * s;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tp = 2 * l - q;\r\n\t\t\t\t\t\thK = h / 360;\r\n\t\t\t\t\t\ttR = hK + 1 / 3;\r\n\t\t\t\t\t\ttG = hK;\r\n\t\t\t\t\t\ttB = hK - 1 / 3;\r\n\t\t\t\t\t\tlet correctRGB = t => {\r\n\t\t\t\t\t\t\tif (t < 0) {\r\n\t\t\t\t\t\t\t\treturn t + 1.0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (t > 1) {\r\n\t\t\t\t\t\t\t\treturn t - 1.0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn t;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tlet createRGB = t => {\r\n\t\t\t\t\t\t\tif (t < 1 / 6) {\r\n\t\t\t\t\t\t\t\treturn p + (q - p) * 6 * t;\r\n\t\t\t\t\t\t\t} else if (t >= 1 / 6 && t < 1 / 2) {\r\n\t\t\t\t\t\t\t\treturn q;\r\n\t\t\t\t\t\t\t} else if (t >= 1 / 2 && t < 2 / 3) {\r\n\t\t\t\t\t\t\t\treturn p + (q - p) * 6 * (2 / 3 - t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tr = tR = Math.round(createRGB(correctRGB(tR)) * 255);\r\n\t\t\t\t\t\tg = tG = Math.round(createRGB(correctRGB(tG)) * 255);\r\n\t\t\t\t\t\tb = tB = Math.round(createRGB(correctRGB(tB)) * 255);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ta && (target[n] = a);\r\n\t\t\t\t\ttarget[n - 3] = r;\r\n\t\t\t\t\ttarget[n - 2] = g;\r\n\t\t\t\t\ttarget[n - 1] = b;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet prvX = this.prvX,\r\n\t\t\t\tprvY = this.prvY,\r\n\t\t\t\tprvWidth = this.prvWidth,\r\n\t\t\t\tprvHeight = this.prvHeight;\r\n\r\n\t\t\tthis.ctxCanvasPrv.setFillStyle('black');\r\n\t\t\tthis.ctxCanvasPrv.fillRect(prvX, prvY, prvWidth, prvHeight);\r\n\t\t\tthis.ctxCanvasPrv.draw(true);\r\n\r\n\t\t\t// #ifdef APP-PLUS||H5\r\n\t\t\tprvX *= this.pixelRatio;\r\n\t\t\tprvY *= this.pixelRatio;\r\n\t\t\tprvWidth *= this.pixelRatio;\r\n\t\t\tprvHeight *= this.pixelRatio;\r\n\t\t\t// #endif\r\n\t\t\tuni.canvasPutImageData(\r\n\t\t\t\t{\r\n\t\t\t\t\tcanvasId: 'prv-canvas',\r\n\t\t\t\t\tx: prvX,\r\n\t\t\t\t\ty: prvY,\r\n\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\tdata: target,\r\n\t\t\t\t\tfail() {},\r\n\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t},\r\n\t\tbtop(base64) {\r\n\t\t\treturn new Promise(function(resolve, reject) {\r\n\t\t\t\tvar arr = base64.split(','),\r\n\t\t\t\t\tmime = arr[0].match(/:(.*?);/)[1],\r\n\t\t\t\t\tbstr = atob(arr[1]),\r\n\t\t\t\t\tn = bstr.length,\r\n\t\t\t\t\tu8arr = new Uint8Array(n);\r\n\t\t\t\twhile (n--) {\r\n\t\t\t\t\tu8arr[n] = bstr.charCodeAt(n);\r\n\t\t\t\t}\r\n\t\t\t\treturn resolve(\r\n\t\t\t\t\t(window.URL || window.webkitURL).createObjectURL(\r\n\t\t\t\t\t\tnew Blob([u8arr], { type: mime })\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style>\r\n.my-canvas {\r\n\tdisplay: flex;\r\n\tposition: fixed !important;\r\n\tbackground: #000000;\r\n\tleft: 0;\r\n\tz-index: 100000;\r\n\twidth: 100%;\r\n}\r\n.my-avatar {\r\n\twidth: 150upx;\r\n\theight: 150upx;\r\n\tborder-radius: 100%;\r\n}\r\n.oper-canvas {\r\n\tdisplay: flex;\r\n\tposition: fixed !important;\r\n\tleft: 0;\r\n\tz-index: 100001;\r\n\twidth: 100%;\r\n}\r\n.prv-canvas {\r\n\tdisplay: flex;\r\n\tposition: fixed !important;\r\n\tbackground: #000000;\r\n\tleft: 0;\r\n\tz-index: 200000;\r\n\twidth: 100%;\r\n}\r\n.oper-wrapper {\r\n\theight: 50px;\r\n\tposition: fixed !important;\r\n\tbox-sizing: border-box;\r\n\tborder: 1px solid #f1f1f1;\r\n\tbackground: #ffffff;\r\n\twidth: 100%;\r\n\tleft: 0;\r\n\tbottom: 0;\r\n\tz-index: 100009;\r\n\tflex-direction: row;\r\n}\r\n.oper {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: center;\r\n\tpadding: 10upx 20upx;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tbox-sizing: border-box;\r\n\talign-self: center;\r\n}\r\n.btn-wrapper {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\t/* #ifndef H5 */\r\n\tflex-grow: 1;\r\n\t/* #endif */\r\n\t/* #ifdef H5 */\r\n\theight: 50px;\r\n\t/* #endif */\r\n\tjustify-content: space-between;\r\n}\r\n.btn-wrapper view {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tfont-size: 16px;\r\n\tcolor: #333;\r\n\tborder: 1px solid #f1f1f1;\r\n\tborder-radius: 6%;\r\n}\r\n.hover {\r\n\tbackground: #f1f1f1;\r\n\tborder-radius: 6%;\r\n}\r\n.clr-wrapper {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\tflex-grow: 1;\r\n}\r\n.clr-wrapper view {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tfont-size: 16px;\r\n\tcolor: #333;\r\n\tborder: 1px solid #f1f1f1;\r\n\tborder-radius: 6%;\r\n}\r\n.my-slider {\r\n\tflex-grow: 1;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./oa-avatar.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./oa-avatar.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1683953178136\n      var cssReload = require(\"C:/Users/86152/Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}